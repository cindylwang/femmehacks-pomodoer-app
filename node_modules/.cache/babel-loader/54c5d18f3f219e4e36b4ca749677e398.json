{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState, useRef } from 'react';\nimport socketIOClient from 'socket.io-client';\nconst SOCKET_SERVER_URL = 'http://localhost:4000';\nconst TIMER_START_STOP = 'timerPush';\nconst TIMER_WORK_REST = 'workRestPush';\nconst TIME = 'time';\n\nconst useTimer = roomId => {\n  _s();\n\n  const [start, setStart] = useState(false);\n  const [work, setWork] = useState(true);\n  const [minutes, setMinutes] = useState(25);\n  const [seconds, setSeconds] = useState(0);\n  const socketRef = useRef(); //function for decrementing timer\n\n  const decrement = () => {\n    if (start === true) {\n      const intervalId = setInterval(() => {\n        setSeconds(prev => prev - 1);\n      }, 1000);\n      return () => {\n        clearInterval(intervalId);\n      };\n    }\n  };\n\n  useEffect(decrement, [start]);\n\n  const time = () => {\n    if (start === true) {\n      if (seconds === -1 && minutes !== 0) {\n        setSeconds(59);\n        setMinutes(prev => prev - 1);\n      } else if (minutes === 0 && seconds === -1 && work === true) {\n        setMinutes(5);\n        setSeconds(0);\n        setWork(false);\n      } else if (minutes === 0 && seconds === -1 && work === false) {\n        setMinutes(25);\n        setSeconds(0);\n        setWork(true);\n      }\n    }\n  };\n\n  useEffect(time);\n  useEffect(() => {\n    // creates websocket connection\n    socketRef.current = socketIOClient(SOCKET_SERVER_URL, {\n      query: {\n        roomId\n      }\n    }); // listens for timer start/stop push\n\n    socketRef.current.on(TIMER_START_STOP, data => {\n      setStart(!data.start);\n    });\n    socketRef.current.on(TIMER_WORK_REST, data => {\n      work = data.work;\n      setWork(!work);\n\n      if (work === true) {\n        setMinutes(5);\n        setSeconds(0);\n      } else {\n        setMinutes(25);\n        setSeconds(0);\n      }\n    }); // destroy socket reference when the connection is closed\n\n    return () => {\n      socketRef.current.disconnect();\n    };\n  }, [roomId, start]); //sends message to server that forwards to all users in room\n\n  const sendStart = start => {\n    socketRef.current.emit(TIMER_START_STOP, {\n      start: start\n    });\n  };\n\n  const sendWork = work => {\n    socketRef.current.emit(TIMER_WORK_REST, {\n      work: work\n    });\n  };\n\n  const sendTime = (minutes, seconds) => {\n    socketRef.current.emit(TIME, {\n      minutes: minutes,\n      seconds: seconds\n    });\n  };\n\n  return {\n    start,\n    sendStart,\n    work,\n    sendWork,\n    minutes,\n    seconds,\n    sendTime\n  };\n};\n\n_s(useTimer, \"oATiEHW+n41fIkygLZleBU+ghjE=\");\n\nexport default useTimer;","map":{"version":3,"sources":["/Users/bubird/Documents/GitHub/femmehacks-pomodoer-app/src/useTimer.js"],"names":["useEffect","useState","useRef","socketIOClient","SOCKET_SERVER_URL","TIMER_START_STOP","TIMER_WORK_REST","TIME","useTimer","roomId","start","setStart","work","setWork","minutes","setMinutes","seconds","setSeconds","socketRef","decrement","intervalId","setInterval","prev","clearInterval","time","current","query","on","data","disconnect","sendStart","emit","sendWork","sendTime"],"mappings":"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","sourcesContent":["import {useEffect, useState, useRef} from 'react';\nimport socketIOClient from 'socket.io-client';\n\nconst SOCKET_SERVER_URL = 'http://localhost:4000';\nconst TIMER_START_STOP = 'timerPush';\nconst TIMER_WORK_REST = 'workRestPush';\nconst TIME = 'time';\n\nconst useTimer = (roomId) => {\n    const [start, setStart] = useState(false);\n    const [work, setWork] = useState(true);\n    const [minutes, setMinutes] = useState(25);\n    const [seconds, setSeconds] = useState(0);\n    const socketRef = useRef();\n\n    //function for decrementing timer\n    const decrement = () => {\n        if (start === true) {\n        const intervalId = setInterval(() => {\n            setSeconds((prev) => prev - 1);\n        }, 1000);\n        return () => {\n            clearInterval(intervalId);\n        };\n        }\n    }\n    useEffect(decrement, [start]);\n\n    const time = () => {\n        if (start === true){\n          if (seconds === -1 && minutes !== 0) {\n            setSeconds(59);\n            setMinutes((prev) => prev - 1);\n          } else if (minutes === 0 && seconds === -1 && work === true ) {\n            setMinutes(5);\n            setSeconds(0);\n            setWork(false);\n          } else if (minutes === 0 && seconds === -1 && work === false) {\n            setMinutes(25);\n            setSeconds(0);\n            setWork(true);\n          }\n        }\n    }\n\n    useEffect(time);\n\n\n    useEffect(()=> {\n        // creates websocket connection\n        socketRef.current = socketIOClient(SOCKET_SERVER_URL, {\n            query:{roomId},\n        });\n        \n        // listens for timer start/stop push\n        socketRef.current.on(TIMER_START_STOP, (data) => {\n            setStart(!data.start);\n        })\n\n        socketRef.current.on(TIMER_WORK_REST, (data) => {\n            work = data.work\n            setWork(!work)\n            if (work === true){\n                setMinutes(5);\n                setSeconds(0);\n              } else {\n                setMinutes(25);\n                setSeconds(0);\n              }\n    \n        })\n\n        // destroy socket reference when the connection is closed\n        return () => {\n            socketRef.current.disconnect();\n        };\n    }, [roomId,start]);\n\n    //sends message to server that forwards to all users in room\n    const sendStart = (start) => {\n        socketRef.current.emit(TIMER_START_STOP, {\n            start: start\n        });\n    }\n\n    const sendWork = (work) => {\n        socketRef.current.emit(TIMER_WORK_REST, {\n            work: work,\n        })\n    }\n\n    const sendTime = (minutes,seconds) => {\n        socketRef.current.emit(TIME,{\n            minutes: minutes,\n            seconds: seconds,\n        })\n    }\n\n    return {start, sendStart, work, sendWork, minutes, seconds, sendTime}\n}\n\nexport default useTimer\n\n"]},"metadata":{},"sourceType":"module"}